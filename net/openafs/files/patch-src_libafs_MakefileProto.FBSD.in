--- src/libafs/MakefileProto.FBSD.in.orig	2017-12-05 14:43:14 UTC
+++ src/libafs/MakefileProto.FBSD.in
@@ -87,6 +87,10 @@ include Makefile.common
 # we only do the no-NFS case
 OBJS=	${AFSAOBJS} ${AFSNONFSOBJS}
 
+# Ensure that vnode_if.h is built before we try to compile any libafs objects.
+$(OBJS): vnode_if.h
+
+
 LIBAFSNONFS=	libafs.ko
 DEFINES= -DAFSDEBUG -DKERNEL -DAFS -DVICE -DNFS -DUFS -DINET -DQUOTA -DGETMOUNT
 CFLAGS+= $(DEFINES) ${COMMON_INCLUDE}
